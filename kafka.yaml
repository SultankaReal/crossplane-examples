apiVersion: mdb.yandex-cloud.jet.crossplane.io/v1alpha1
kind: KafkaCluster
metadata:
  name: example-kafka
spec:
  forProvider:
    name: example-kafka
    environment: PRESTABLE
    networkIdRef:
      name: default
    config:
      - version: "3.3"
        resources:
          - diskSize: 32
            diskTypeId: network-ssd
            resourcePresetId: s2.micro
        kafkaConfig:
          compression_type: "COMPRESSION_TYPE_ZSTD"
          log_flush_interval_messages: 1024
          log_flush_interval_ms: 1000
          log_flush_scheduler_interval_ms: 1000
          log_retention_bytes: 1073741824
          log_retention_hours: 168
          log_retention_minutes: 10080
          log_retention_ms: 86400000
          log_segment_bytes: 134217728
          log_preallocate: true 
          num_partitions: 10
          default_replication_factor: 1
          message_max_bytes: 1048588
          replica_fetch_max_bytes: 1048576
          ssl_cipher_suites: ["TLS_DHE_RSA_WITH_AES_128_CBC_SHA", "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"]
          offsets_retention_minutes: 10080
          sasl_enabled_mechanisms: ["SASL_MECHANISM_SCRAM_SHA_256", "SASL_MECHANISM_SCRAM_SHA_512"]
    maintenanceWindow:
      - type: WEEKLY
        day: SAT
        hour: 12
    database:
      - name: db_name
        owner: user1
    user:
      - name: user1
        passwordSecretRef:
          name: postgresql
          key: password
          namespace: default
        connLimit: 50
        permission:
          - databaseName: db_name
        settings:
          default_transaction_isolation: "read committed"
          log_min_duration_statement: "5000"
    host:
      - zone: ru-central1-a
        subnetIdRef:
          name: default-ru-central1-a
    folderIdRef:
      name: nkalniyazov
  providerConfigRef:
    name: example
